/**
 * \file        governingEq.doc
 * \author      Cyrille Bonamy and Julien Chauchat
 * \date        June 06, 2021
 * \brief       SedFOAM governing equations
 */
/*! \page governing Governing equations 

The mathematical formulation of the Eulerian two-phase flow model sedFoam is obtained by averaging local and instantaneous mass and momentum conservation equations over fluid and dispersed particles. Different averaging operators can be used, ensemble averaging (Drew, 1983) or spatial averaging (Jackson, 2000), and provided that the mathematical derivation is done properly the different approaches should lead to the same conservation equations (Zhang and Prosperetti, 1997; Jackson, 1997). The resulting governing equations can be considered as the counterpart of the clear fluid Navier-Stokes equations for single phase flow. In order to apply these equations to turbulent flow, in which turbulent motions are generated by flow shear much larger than the grain scale, additional turbulence averaging or filtering is required. In the present model, turbulence-averaged Eulerian two-phase flow equations are derived by following a similar procedure presented in Hsu et al. (2003); Hsu and Liu (2004).

\section turbAvg Turbulence-averaged two-phase flow governing equations

The mass conservation equations for the particle phase and fluid phase are written as:

\f$
\frac{\partial {\alpha}}{\partial {t}} + \frac{\partial{{\alpha}u^a_i}}{\partial{x_i}}=0,
\label{eq_conti_sed}
\f$

\f$
\frac{\partial \beta}{\partial {t}} + \frac{\partial{\beta u^b_i}}{\partial{x_i}}=0,
\label{eq_conti_fl}
\f$

where \f$\alpha\f$, and \f$\beta=1-\alpha\f$ are the particle and fluid volume concentrations, \f$u^a_i, u^b_i\f$ are the sediment and fluid phase velocities, and \f$i=1, 2, 3\f$ represents streamwise, spanwise and vertical component, respectively. The momentum equations for fluid and particle phases can be written as:

\f$
\frac{\partial {\rho^a}{\alpha}u^a_i}{\partial {t}} + \frac{\partial{{\rho^a}{\alpha}u^a_iu^a_j}}{\partial{x_j}}=-{\alpha}\frac{\partial{p}}{\partial{x_i}}+{\alpha}f_i-\frac{\partial{\tilde{p}^a}}{\partial{x_i}}+\frac{\partial{\tau^a_{ij}}}{\partial{x_j}} + {\alpha}{\rho^a}g_i  + {\alpha}f_i + {\alpha}{\beta}K(u^b_i-u^a_i)- S_{US} \ {\beta}K\nu_t^{b}\frac{\partial{\alpha}}{\partial{x_i}},
\label{eq_mom_sed}
\f$

\f$
\frac{\partial {\rho^b}{\beta}u^b_i}{\partial {t}} + \frac{\partial{{\rho^b}{\beta}u^b_iu^b_j}}{\partial{x_j}}=-\beta\frac{\partial{p}}{\partial{x_i}}+\beta f_i+\frac{\partial{\tau^b_{ij}}}{\partial{x_j}} + {\beta}{\rho^b}g_i +{\beta}f_i-{\alpha}{\beta}K(u^b_i-u^a_i)+ S_{US} \  {\beta}K{\nu_t^{b}}\frac{\partial{\alpha}}{\partial{x_i}},
\label{eq_mom_fl}
\f$

where \f$\rho^a, \rho^b\f$ are particle and fluid density, respectively, \f$g_i\f$ is the gravitational acceleration, \f$f_i\f$ is an external volume force and \f$p\f$ is the fluid pressure. \f$f_i\f$ is the external force that drives the flow. The fluid stress \f$\tau^b_{ij}\f$ includes fluid grain-scale (viscous) stress and fluid Reynolds stresses (see section ref{Fshear}) and  \f$\tilde{p}^a, \tau^a_{ij}\f$ are particle normal stress and shear stress (see section ref{Sshear}). The last two terms on the right-hand-side (RHS) of equations ref{eq_mom_sed} and ref{eq_mom_fl} are momentum coupling between the fluid phase and particle phase through drag force, where \f$K\f$ is the drag parameter. In particular the second to the last term represents averaged drag force due to mean relative velocity between fluid and particle phases, while the last term represents the fluid turbulent suspension term, also called drift velocity by Simonin (1991). This term is due to the correlation of sediment concentration and fluid velocity fluctuations and the gradient transport assumption is adopted here for its closure. Hence, \f$\nu_t^{b}\f$ is the turbulent viscosity to be calculated using a turbulence closure, and \f$S_{US} = 1/\sigma_c\f$ is inverse of the the Schmidt number. This term is equivalent to the turbulent suspension flux of the Rouse profile in the two-phase flow formalism (see  Chauchat (2018) appendix 1 for a detailed demonstration). Other forces such as the lift force or the added mass force could play a role in sediment transport, according to Jha and Bombardelli (2010), the lift force in dilute suspended sediment transport only represent 4\% of the drag force and the added mass force can be of order of 10%  in the near bed region. The influence of the added mass force would require further investigation that are beyond the scope of the present paper. 

The drag parameter \f$K\f$, is modeled following Schiller and Naumann (1933):

\f$
\label{eq:Cd}
K=0.75 C_d \frac{\rho^b}{d_{eff}} \parallel \mathbf{u^b}-\mathbf{u^a}\parallel\beta^{-h_{Exp}}
\f$

where \f$d_{eff}= {\psi}d\f$ is the effective sediment diameter, in which \f$\psi\f$ is the shape factor and \f$d\f$ is the particle diameter. The hindrance function \f$\beta^{-h_{Exp}}\f$ represents the drag increase when the particle volume concentration increases. \f$h_{Exp}\f$ is the hindrance exponent that depends on the particulate Reynolds number Di Felice (1994). For simplicity, the value of \f$h_{Exp}\f$ is assumed to be constant (default value is 2.65), and its value can be specified from the *constant/transportProperties* file in SedFoam-2.0. This hypothesis is valid for particulate Reynolds numbers lower than unity or larger than 300, within this range the exponent value decreases down to \f$h_{Exp}\approx2\f$. The drag coefficient \f$C_d\f$ is calculated as:

\f$
\label{eq:drag}
C_d=\left\{
\begin{array}{r}
\frac{24}{Re_p}(1+0.15 Re_p^{0.687}), \quad \quad Re_p \leq 1000 \\
0.44, \quad  \quad Re_p>1000
\end{array},
\right.
\f$

in which, the particulate Reynolds number \f$Re_p\f$ is defined as: \f$Re_p=\beta\parallel\mathbf{u^b-u^a}\parallel d_{eff}/\nu^b\f$, where \f$\nu^b\f$ stands for the fluid kinematic viscosity. This drag model can be chosen by the keyword ``GidaspowSchillerNaumann'' in the file *constant/interfacialProperties* and it is especially well adapted for dealing with suspended particles. For situation in which the fluid flow inside the porous sediment bed has to be accurately solved, other drag models are available in SedFoam-2.0 but as they are not relevant to the test cases investigated in this paper, their description is omitted. The major issue in developing a Eulerian two-phase flow model is to provide closure laws for turbulence closures and granular stress models. This will be extensively discussed in the following subsections, particularly different modeling options available in SedFoam-2.0  are presented.


\subsection fluidstress Fluid phase shear stress 

Because the present model equations are obtained by averaging over turbulence, the fluid stresses consist of a large-scale component \f$R_{ij}^{bt}\f$ (*i.e.*, Reynolds stress) and a grain-scale stress \f$r_{ij}^b\f$, which includes the viscous stress and an additional effect due to fluid-particle interaction at grain scale. The total fluid stress is written as:

\f$
\tau^b_{ij}=R_{ij}^{bt} +r_{ij}^b=\rho^b\beta\Big[2\nu_{Eff}^{b} \ S_{ij}^b-\frac{2}{3}k\delta_{ij}\Big],
\label{eq_tauf}
\f$

where, \f$\nu_{Eff}^{b}=\nu_t^{b}+\nu^{mix}\f$ is the fluid phase effective viscosity with \f$\nu_t^{b}\f$ being the eddy viscosity, and \f$\nu^{mix}\f$ is the mixture viscosity. \f$S_{ij}^b\f$ is the deviatoric part of the fluid phase strain rate tensor defined as:

\f$
S_{ij}^b = \frac{1}{2}\big(\frac{\partial{u^b_i}}{\partial{x_j}} + \frac{\partial{u^b_j}}{\partial{x_i}}\big)-\frac{1}{3}\frac{\partial{u^b_k}}{\partial{x_k}}\delta_{ij},
\label{eq_Sijb}
\f$

The Reynolds stress tensor \f$R_{ij}^{bt}\f$ is modeled as:

\f$
R_{ij}^{bt} =\rho^b\beta\Big[2 \nu_t^{b} \ S_{ij}^b  -\frac{2}{3}k\delta_{ij}\Big],
\label{eq_tauft}
\f$

and the viscous stress tensor is modeled as:
\f$
r_{ij}^{b} =2\rho^b\beta\nu^{mix} \ S_{ij}^b, 
\label{eq_rft}
\f$

In SedFoam-2.0, several different viscosity or turbulence closures are implemented, and these models can be selected according to specific flow conditions ranging from laminar to turbulent flows, and in particular, the mixture viscosity can be selected in combination of granular rheology model for the granular stresses (see section ref{granularRheo}). For the turbulent eddy viscosity, modified turbulence closures are implemented for sediment transport applications, and they are presented in subsection ref{TurbulenceModeling}.


\subsection particleStress Particle phase stress

In sediment transport applications, the particle stress are important mechanisms to support particle immersed weight in concentrated regions of sediment transport  (Hsu et al., 2004; Cheng et al., 2017). In these regions, the momentum exchanges due to particle collisions and/or enduring contacts exert dispersive stresses on a collection of particles. The particle phase stress tensor can be split into the normal and off-diagonal components that correspond to the particle pressure \f$\tilde{p}^a\f$ and the particle shear stress \f$\tilde{\tau}^a_{ij}\f$. Though, details varies with the model selection, the particle normal stresses (or pressure) can be generally classified into two contributions: a shear induced or collisional component (super-script `a') and a permanent contact component (super-script `ff') (Johnson and Jackson, 1987):

\f$
\tilde{p}^a=p^{ff}+p^{a},
\label{eq_ps}
\f$

The first term the particle pressure is due to enduring contact in highly concentrated region, where sediment bed is quasi-static/immobile. This normal pressure increases rapidly when the sediment concentration is close to maximum packing limit, and prevents unphysical sediment concentration in the sediment bed. Thus this element is important to model a full transport profile including the quasi-static sediment bed. The permanent contact component \f$p^{ff}\f$ is calculated as: 

\f$
p^{ff}=\left\{
\begin{array}{r}
0, \alpha < \alpha_{min}^{Fric} \\
Fr\frac{(\alpha-\alpha_{min}^{Fric})^{\eta_0}}{(\alpha_{max}-\alpha)^{\eta_1}}, \alpha \geq \alpha_{min}^{Fric},
\end{array}
\right.
\label{eq:paff}
\f$

where \f$\alpha_{min}^{Fric}=0.57\f$, \f$\alpha_{max}=0.635\f$ for spheres and \f$Fr\f$, \f$\eta_0\f$ and \f$\eta_1\f$ are empirical coefficients. Following Cheng et al.(2017) the values are set to: \f$Fr=0.05, \eta_0=3\f$ and \f$\eta_1=5\f$. Again, these coefficients can be reset in file *constant/kineticTheoryProperties* or  *constant/granularRheologyProperties* by specifying the keywords and values (see notations list in appendix ref{notations}).

In modern sediment transport modeling framework, two major threads of modeling approach for shear-induced/collisional particle normal stress and shear stress are kinetic theory of granular flows and dense granular flow rheology. They are implemented in this version of SedFoam-2.0 (see subsection ref{sec:kinetic} and ref{granularRheo}), respectively. As a result of different closures for particle normal stresses \f$p^a\f$, the closure for the total particle shear stress \f$\tilde{\tau}^a_{ij}\f$ also varies, and they are described in the next two subsections.

The particle phase shear stress expression depends on the chosen granular stress model between kinetic theory of granular flows or dense granular flow rheology. For the later only the frictional stress is considered while for the former a collisional contribution is also considered.

For the dense granular flow rheology the particle phase shear stress is written as:

\f$
\tilde{\tau}^a_{ij}=\mu({\rm I}) \ \tilde{p}^a \ \frac{S^a_{ij}}{\sqrt{2 \ S^a_{ij}{\cdot}S^a_{ij}}},
\label{taus_muI}
\f$

where \f$S_{ij}^a\f$ is the deviatoric part of sediment phase strain rate tensor:

\f$
S_{ij}^{a}=\frac{1}{2}\Big(\frac{\partial{u^a_i}}{\partial{x_j}}+\frac{\partial{u^a_j}}{\partial{x_i}}\Big)-\frac{1}{3}\dfrac{\partial{u^a_k}}{\partial{x_k}}\delta_{ij},
\label{eq_Ssf}
\f$

The dynamic friction coefficient $\mu$ depends on the dimensionless controlling number `${\rm I}$'. Depending on the local Stokes and particulate Reynolds numbers, the regime of the granular flow rheology can change from free fall or grain inertia regime to viscous and turbulent regimes (Andreotti et al., 2013), and the definition of the controlling parameter `${\rm I}$' are different accordingly. In SedFoam-2.0, the grain inertia and viscous regimes have been implemented and can be selected using the keywords `MuI' and `MuIv' respectively. To be consistent with the definitions used in the kinetic theory, we still introduce the the particle shear viscosity $\mu^a$ and frictional shear viscosity \f$\nu_{Fr}^a\f$. However, we simply set \f$\mu^a=0\f$, and the define the frictional shear viscosity alone as  (Chauchat and Médale, 2014):

\f$
\nu_{Fr}^a=\frac{\mu(I) \ \tilde{p}^a}{\rho^a \ \left(\parallel\mathbf{\sf S^a}\parallel^2+D_{small}^2\right)^{1/2}},
\label{nufra_mui}
\f$

where \f$\parallel\mathbf{\sf S^a}\parallel\f$ is the norm of the shear rate tensor (Eq. ref{eq_Ssf}). \f$D_{small}\f$ is the regularization parameter, which is introduced to avoid singularity. It is set to be \f$D_{small}=10^{-6} s^{-1}\f$ for all the simulations of granular rheology presented herein except stated otherwise.


For the kinetic theory, following Gidaspow (1994), the particle collisional stress is calculated as:

\f$
\tau_{ij}^{a}=2\mu^a \ S_{ij}^{a}+ \lambda \frac{\partial{u^a_k}}{\partial{x_k}}\delta_{ij}.
\label{eq_tausc}
\f$

For more details, the interested reader is refered to Chauchat et al. (2017).

*/
